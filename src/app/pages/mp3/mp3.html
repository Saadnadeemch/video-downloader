<app-navbar></app-navbar>

<section class="pt-28 pb-16 bg-gradient-to-br from-purple-50 via-white to-pink-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

    <!-- Hero -->
    <div class="text-center mb-12">
      <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-6">
        Download Audio
        <span class="block bg-gradient-to-r from-purple-600 to-indigo-600 bg-clip-text text-transparent">
          in MP3
        </span>
      </h1>
      <p class="text-lg md:text-xl text-gray-600 max-w-3xl mx-auto mb-8">
        Extract high-quality audio from any video. Perfect for music, podcasts,
        and audio content from your favorite platforms.
      </p>
    </div>

<div class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
    <!-- Input + Buttons -->
    <div class="flex flex-col md:flex-row gap-3 md:gap-4 items-stretch md:items-center">
      <!-- Input -->
      <div class="relative flex-1 group">
        <input
          type="text"
          [(ngModel)]="url"
          placeholder="Paste video link here"
          class="h-12 md:h-16 pl-4 md:pl-6 pr-12 md:pr-16 text-base md:text-lg 
                 border border-gray-200 rounded-xl md:rounded-2xl bg-gray-50 
                 transition-all duration-300 w-full
                 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:bg-white" />

        <!-- Paste button -->
        <button
          type="button"
          *ngIf="!url; else clearButton"
          (click)="handlePaste()"
          class="absolute right-2 md:right-3 top-1/2 transform -translate-y-1/2 
                 h-8 w-8 md:h-10 md:w-10 p-0 hover:bg-purple-100 rounded-lg md:rounded-xl 
                 transition-all duration-200 flex items-center justify-center text-xl"
          title="Paste from clipboard">
          <img src="paste-icon.png" class="h-8" alt="">
        </button>

        <!-- Clear button -->
        <ng-template #clearButton>
          <button
            type="button"
            (click)="url = ''"
            class="absolute right-2 md:right-3 top-1/2 transform -translate-y-1/2 
                   h-8 w-8 md:h-10 md:w-10 p-0 hover:bg-red-100 rounded-lg md:rounded-xl 
                   transition-all duration-200 flex items-center justify-center text-xl text-red-500"
            title="Clear input">
            <img src="remove-icon.png" class="h-10" alt="">
          </button>
        </ng-template>
      </div>

      <!-- Get Info Button -->
      <button
        (click)="handleDownloadRequest()"
        [disabled]="isLoading"
        class="h-12 md:h-16 w-full md:w-auto px-6 md:px-10 font-semibold 
               bg-gradient-to-r from-purple-600 to-indigo-600 
               hover:from-purple-700 hover:to-indigo-700
               text-white rounded-xl md:rounded-2xl transition-all duration-300 
               shadow hover:shadow-lg flex items-center justify-center 
               mt-2 md:mt-0 focus:ring-2 focus:ring-purple-400">
        <ng-container *ngIf="isLoading; else notLoading">
          <svg class="w-5 h-5 animate-spin mr-2" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="10" stroke="white" stroke-width="4" fill="none" />
            <path d="M12 2a10 10 0 1 1-9.95 9H12V2z" fill="white" />
          </svg>
          Processing...
        </ng-container>
        <ng-template #notLoading>
          Get Video Info
        </ng-template>
      </button>
    </div>
</div>
    <!-- Loading Skeleton -->
    <div *ngIf="isLoading" class="bg-white rounded-2xl shadow-lg p-8 mt-6 animate-pulse">
      <div class="flex flex-col md:flex-row gap-6">
        <div class="w-full md:w-48 h-32 bg-gray-300 rounded-xl"></div>
        <div class="flex-1 space-y-4">
          <div class="h-6 bg-gray-300 rounded w-3/4"></div>
          <div class="h-4 bg-gray-300 rounded w-1/2"></div>
          <div class="h-4 bg-gray-300 rounded w-1/3"></div>
          <div class="h-10 bg-gray-300 rounded w-32"></div>
        </div>
      </div>
    </div>

    <!-- Audio Info -->
    <div *ngIf="audioInfo" class="bg-white rounded-3xl shadow-xl p-6 md:p-8 border border-gray-100 mt-6">
      <div class="flex flex-col lg:flex-row gap-6 md:gap-8">
        <!-- Thumbnail -->
        <div class="w-full lg:w-80 flex-shrink-0">
          <img
            [src]="audioInfo.thumbnail || 'default.jpg'"
            [alt]="audioInfo.title || 'Audio Thumbnail'"
            class="w-full h-36 md:h-48 object-cover rounded-xl shadow-lg" />
        </div>

        <!-- Info & Progress -->
        <div class="flex-1">
          <h3 class="text-xl md:text-2xl font-bold text-gray-900 mb-2">{{ audioInfo.title }}</h3>
          <div class="flex flex-wrap items-center gap-3 mb-4 text-gray-600 text-sm">
            <span class="font-semibold">Author: {{ audioInfo.uploader }}</span>
            <span>{{ audioInfo.views }} views</span>
            <span>{{ audioInfo.likes }} likes</span>
          </div>

          <!-- Progress / Download / Error -->
          <div *ngIf="showProgress || errorMessage || downloadReady" class="space-y-3">
            <!-- Progress Bar -->
            <div *ngIf="showProgress" class="w-full md:max-w-xl h-[15px] rounded-full bg-gray-200 overflow-hidden">
              <div
                class="h-full bg-gradient-to-r from-purple-600 to-indigo-600 rounded-full transition-all duration-500"
                [style.width.%]="progressPercent"></div>
            </div>

            <!-- Download Button -->
            <button
              (click)="downloadReady ? handleDownloadFile() : null"
              class="w-full md:w-auto font-semibold rounded-full py-2 px-6 shadow-lg transition-all duration-300 
                     text-sm flex items-center justify-center gap-2 text-white
                     bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700">
              {{ downloadReady ? 'Save To Device' : downloadText }}
            </button>

            <!-- Error Message -->
            <div
              *ngIf="errorMessage"
              class="flex items-center justify-center gap-2 bg-red-100 text-red-600 px-4 py-2 rounded-md text-sm text-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M12 9v2m0 4h.01M12 2a10 10 0 100 20 10 10 0 000-20z"/>
              </svg>
              {{ errorMessage }}
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Features -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto mt-16">
      <!-- Feature 1 -->
      <div class="bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 text-center group hover:-translate-y-1">
        <div class="text-purple-600 mb-4 flex justify-center group-hover:scale-110 transition-transform duration-200">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 19V6l12-2v13"/>
            <circle cx="6" cy="18" r="3"/>
            <circle cx="18" cy="16" r="3"/>
          </svg>
        </div>
        <h3 class="text-lg font-bold text-gray-900 mb-2">High Quality MP3</h3>
        <p class="text-gray-600 text-sm">Download audio in the highest quality available</p>
      </div>

      <!-- Feature 2 -->
      <div class="bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 text-center group hover:-translate-y-1">
        <div class="text-purple-600 mb-4 flex justify-center group-hover:scale-110 transition-transform duration-200">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v18m9-9H3"/>
          </svg>
        </div>
        <h3 class="text-lg font-bold text-gray-900 mb-2">Multiple Formats</h3>
        <p class="text-gray-600 text-sm">MP3, AAC, FLAC, and more audio formats</p>
      </div>

      <!-- Feature 3 -->
      <div class="bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 text-center group hover:-translate-y-1">
        <div class="text-purple-600 mb-4 flex justify-center group-hover:scale-110 transition-transform duration-200">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M18.364 5.636a9 9 0 0 1 0 12.728M15.536 8.464a5 5 0 0 1 0 7.072M12 12v.01"/>
            <circle cx="12" cy="12" r="3"/>
          </svg>
        </div>
        <h3 class="text-lg font-bold text-gray-900 mb-2">Crystal Clear</h3>
        <p class="text-gray-600 text-sm">Preserve original audio quality and clarity</p>
      </div>
    </div>

  </div>
</section>

<!-- Footer -->
<footer class="bg-gray-900 text-white py-8 mt-12">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
    <div class="mb-8">
      <h3 class="text-2xl font-bold mb-2">VideoFlow</h3>
      <p class="text-gray-400">High-quality audio extraction made simple</p>
    </div>
    <div class="border-t border-gray-800 pt-6">
      <p class="text-gray-400">Â© 2025 VideoFlow. All rights reserved.</p>
    </div>
  </div>
</footer>
